<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>入库管理</title>
		<link href="../css/base.css" rel="stylesheet">
		<link rel="stylesheet" href="../custom/uimaker/easyui.css">
		<link rel="stylesheet" type="text/css" href="../custom/uimaker/icon.css">
		<link rel="stylesheet" href="../css/providers1.css">
		<script type="text/javascript" src="../custom/jquery.min.js"></script>
	    <script type="text/javascript" src="../custom/jquery.easyui.min.js"></script>
	    <script type="text/javascript" src="../custom/easyui-lang-zh_CN.js"></script>
	</head>
<body>
 	<div class="container" style="width:100%;">
       <table class="easyui-datagrid"  id="dgEnshrineInfo" style="width:100%;"    data-options="
                rownumbers:true,
                singleSelect:false,
                autoRowHeight:false,
                pagination:true,
                fitColumns:true,
                striped:true,
                collapsible:true,
                toolbar:'#tb',
                pageSize:10,
                url:'../enshrineInfo/findAllEnshrineInfo.do'">
            <thead>
                <tr>
                	<th field="ck" checkbox="true" align="center" width="50px"></th>
                    <th field="warehous_id" align="center" width="50px">入库编号</th>
                    <th field="warehous_name" align="center" width="50px">物品名称</th>
                    <th field="classes" align="center" width="50px">类别</th>
                    <th field="weight" align="center" width="50px">重量</th>
                    <th field="sorter_jobNum" align="center" width="50px">分拣员</th>
                    <th field="collect" align="center" width="50px">入库时间</th>
                    <th field="remark" align="center" width="60px">备注</th>
                    <th field="state" align="center" width="60px">状态</th>
                    <th field="opt_id" align="center" width="60px">操作人员</th>
                </tr>
            </thead>
        </table>
      <div id="tb" style="padding:0 30px;width:100%;">
        <div class="opt-buttons" style="width:100%;">
            <a href="javascript:newEnshrineInfo()" class="easyui-linkbutton" data-options="selected:true">日期查询</a>
            <a href="javascript:updateEnshrineInfo()" class="easyui-linkbutton">分拣员查询</a>
            <a href="#" class="easyui-linkbutton">导出</a>
        	<div class="conditions" style="float:right;margin-right: 20px">
	          	<span class="con-span">物品名称: </span>
	          	<input class="easyui-textbox" type="text" name="searchByName"  id="searchByName" style="width:166px;height:35px;line-height:35px;"></input>
	          	 <a href="javascript:searchEnshrineInfoByName()" class="easyui-linkbutton" iconCls="icon-search" data-options="selected:true">查询</a>
       		</div>
        </div>
      </div>
    </div> 
    
    <!-- 用户操作form表单—START -->
	     <div id="dlg-buttons">
		      <a href="javascript:saveEnshrineInfo()" class="easyui-linkbutton" iconCls="icon-ok">保存</a>
		      <a href="javascript: closeEnshrineAddDialog()" class="easyui-linkbutton" iconCls="icon-cancel">关闭</a>
		 </div> 
	    
	   	<div id="dlgEnshrineInfo" class="easyui-dialog" style="width: 570px;height: 350px;padding: 10px 20px" closed="true" buttons="#dlg-buttons" closable="false">
		    <form id="formEnshrineInfo" method="post">
		          <table cellspacing="5px">
			         <p><input type="hidden" id="warehous_id" name="warehous_id" /></p>
			         <tr>
			              <td>时间检索：</td>
			              <td><input type="text" id="warehous_name" name="warehous_name" class="easyui-validatebox" required="true"/></td>
			              <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
			              <td>人员检索：</td>
							<td> <input id="cc" class="easyui-combobox" name="dept“ dataoptions="valueField:'id',textField:'text',url:'get_data.jsp'"></td> 
							<!-- （2）使用 javascript 创建组合框（combobox）： -->
							<!--  <input id="cc" name="dept" value="aa"> -->
							
			              
			              <!-- <td colspan="1"><a href="javascript:openRecycleChooseDialog()"class="easyui-linkbutton">选择</a></td> -->
			         </tr>
			         <tr>
			              <td>重量：</td>
			              <td><input type="text" id="weight" name="weight" class="easyui-validatebox" required="true"/></td>
			              <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
			              <td>分拣员：</td>
			              <td> <input id="cc" name="dept" value="aa"></td>
			              <<!-- input type="text" id="sorter_jobNum" name="sorter_jobNum" class="easyui-validatebox" required="true"/> -->
<!-- 			              <td colspan="1"><a href="javascript:openRecycleChooseDialog()"class="easyui-linkbutton">选择</a></td>
 -->			         </tr>
			         <!-- <tr>
			         	<td>操作人：</td>
			            <td><input type="text" id="opt_id" name="opt_id" class="easyui-validatebox" required="true"/></td>
			            <td>&nbsp;&nbsp;&nbsp;&nbsp;</td> 
			            <td>状态：</td>
			            <td><input type="text" id="state" name="state" class="easyui-validatebox" required="true"/></td>
			         </tr> -->
			         <tr>
			              <td>备注：</td>
			              <td colspan="4">
			                     <textarea rows="7" cols="50" name="remark" id="remark"></textarea>
			              </td>
			         </tr>
			         
			    </table>
	       </form>
	   </div>
	  <!-- 用户操作form表单—END -->  
	 
  
    <div id="dlg2-buttons">
	      <a href="javascript:chooseRole()" class="easyui-linkbutton" iconCls="icon-ok">确定</a>
	      <a href="javascript:closeRoleDialog()" class="easyui-linkbutton" iconCls="icon-cancel">关闭</a>
	</div>  
	
	<script type="text/javascript">
	var newEnshrineInfoUrl="../enshrineInfo/saveEnshrineInfo.do";
	var updateUserInfoUrl="../enshrineInfo/updateEnshrineInfo.do"
	var urls="";
		//查询按钮
		function searchEnshrineInfoByName() {
		$("#dgEnshrineInfo").datagrid("load",{
			searchByName:$("#searchByName").val()
			})
		}
		
		
	     $('#cc').combobox({
									url:'combobox_data.json',
									valueField:'id',
									textField:'text'});
	    
		
		
		//新增物品
		function newEnshrineInfo(){
			$("#dlgEnshrineInfo").dialog("open").dialog("setTitle","新增数据");
			urls = newEnshrineInfoUrl;
		}
		//新增确认按钮
 		function saveEnshrineInfo(){
 			/* console.info($("#formEnshrineInfo").serialize()); */
 			$("#formEnshrineInfo").form("submit",{
 				url:urls,
 	 			onsubmit:function(){
 	 				return $(this).form("validate");
 	 			},
 	 			success:function(result){
 	 				var result=eval('('+result+')');
 	 				console.log(result.msg);
 	 				if(result.msg){
 	 					$.messager.alert("系统提示","保存成功","info");
 	 					closeEnshrineAddDialog();
 	 					$("#dgEnshrineInfo").datagrid("reload");
 	 				}else{
 	 					$.messager.alert("系统提示","系统繁忙，请稍后再操作","info");
 	 				}		
 	 			}
 			})
 			
 		}
 		//新增数据的关闭按钮及清除表单
 		function closeEnshrineAddDialog(){
 			$("#formEnshrineInfo").form("clear");
 			$("#dlgEnshrineInfo").dialog("close");
 		}
 		//添加用户时提示该用户存不存在
 		$("#warehous_name").blur(function(){
 			var warehous_name=$("#warehous_name").val();
 			$.ajax({
 				url:"../enshrineInfo/findEnshrineInfoByUName.do",
 				type:"post",
 				dataType:"json",
 				data:{warehous_name:warehous_name},
 				success:function(result){
 					if(result.msg){
 						$.messager.alert("系统提示","当前物品已存在","info");
 						$("#warehous_name").val("");
 					}
 				}
 			});
 		});
 		
 		//修改数据
 		function updateEnshrineInfo(){
 			var rows=$("#dgEnshrineInfo").datagrid("getSelections");
 			if(rows.length!=1){
 				$.messager.alert("系统提示","请选择一条数据","warning");
 				return false;
 			}
 			$("#formEnshrineInfo").form("load",rows[0]);
 			$("#dlgEnshrineInfo").dialog("open").dialog("setTitle","修改数据信息");
 			urls= updateEnshrineInfoUrl;
 		}
 		
 		
 		//删除物品
 		function deleteEnshrineInfo(){
 			var rows=$("#dgEnshrineInfo").datagrid("getSelections");
 			if(rows.length==0){
 				$.messager.alert("系统提示","请选择需要删除的用户","warning");
 				return false;
 			}
 			var warehous_ids=[];
 			$.each(rows,function(index,row){
 				warehous_ids.push(row.warehous_id);
 			});
 			var warehousIds=warehous_ids.join(",");
 			$.messager.confirm("系统提示","确认删除<font size=5 color=red>'" + rows.length + "'</font>位用户？",function(r){
 				if(r){
 					$.ajax({
 						url:"../enshrineInfo/deleteEnshrineInfo.do",
 						type:"post",
 						dataType:"json",
 						data:{warehousIds:warehousIds},
 						success:function(result){
 							if(result.msg){
 		 	 					$.messager.alert("系统提示","删除成功","info");
 		 	 					closeEnshrineAddDialog();
 		 	 					$("#dgEnshrineInfo").datagrid("reload");
 		 	 				}else{
 		 	 					$.messager.alert("系统提示","系统繁忙，请稍后再操作","info");
 		 	 				}	
 						}
 					});
 				}
 			});
 		}
	
	
	
	
	
	
	
	
	
	
	</script>
	</body>
</html>